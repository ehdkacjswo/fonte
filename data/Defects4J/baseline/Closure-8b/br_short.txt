Obfuscated code triggers TypeError in Firefox