Optimizations and bug fixes for LinkedHashTreeMap.

The most interesting optimization is to replace ArrayDeque with a manual linked list that reuses the nodes 'parent' field. These optimizations save about 20%.
