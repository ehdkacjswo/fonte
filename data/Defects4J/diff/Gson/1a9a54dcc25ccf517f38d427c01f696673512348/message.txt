incorporated review comments from r768
