Last piece of refactoring wrt #110
