Refactored the Cleaner to traverse rather than recurse child nodes

Avoids the risk of overflowing the stack

Fixes #246
