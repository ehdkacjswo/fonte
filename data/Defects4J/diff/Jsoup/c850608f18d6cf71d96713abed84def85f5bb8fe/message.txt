Resolved PR #470 conflicts

Cleaned up a little, added changes
