Maintain the Parser used when parsing a Document

Allows appropriate fragment parsing as XML or HTML, and remembers case sensitivity choice.

Fixes #769
