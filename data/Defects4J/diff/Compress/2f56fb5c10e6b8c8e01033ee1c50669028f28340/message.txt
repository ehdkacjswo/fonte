ByteBuffer looks convenient but is slow (manual method is 50% faster)
