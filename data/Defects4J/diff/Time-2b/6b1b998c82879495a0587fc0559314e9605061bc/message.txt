make sure streams get closed when exception occurs
