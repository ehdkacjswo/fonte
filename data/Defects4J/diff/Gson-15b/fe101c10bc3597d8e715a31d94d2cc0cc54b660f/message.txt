Merge pull request #719 from google/jwilson_1021_runtime_type_mismatch

Fix type hierarchy adapters to do a runtime check.