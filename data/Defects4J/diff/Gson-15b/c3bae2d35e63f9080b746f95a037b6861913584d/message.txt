incorporating code review comments from r648
