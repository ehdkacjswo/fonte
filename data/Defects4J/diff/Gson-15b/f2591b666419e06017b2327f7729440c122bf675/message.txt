adjusted factory finding code to take into account non-present factories
