Ensuring that the hash is unpredictable and well distributed.

We achieve this by using the same algorithm as the Perl version, but this implementation
is being written from scratch for license compliance.
