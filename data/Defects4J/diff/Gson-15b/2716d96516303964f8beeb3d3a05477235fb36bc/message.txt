Revised ancestor stack to use both object and type
