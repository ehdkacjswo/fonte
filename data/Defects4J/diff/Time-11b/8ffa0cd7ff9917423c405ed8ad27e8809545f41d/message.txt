Fix calculation of month length when day-of-month specified is less than 1

Fixes SF bug 165
