Rewrite whitespace skipping, based on superior speed by code from 2.2; lookup table not that good it seems
