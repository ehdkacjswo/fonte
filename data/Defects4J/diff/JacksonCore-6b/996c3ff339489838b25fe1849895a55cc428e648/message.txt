complete rewriting of number parsing for char-based sources as well
