is_addition,old_file_path,new_file_path,line_num,content
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,476,"return createArchiveInputStream(detect(in), in);"
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,480,* Try to determine the type of Archiver
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,481,* @param in input stream
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,482,* @return type of archiver if found
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,483,* @throws ArchiveException if an archiver cannot be detected in the stream
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,485,public static String detect(InputStream in) throws ArchiveException {
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,496,int signatureLength = -1;
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,487,"nt signatureLength = IOUtils.readFully(in, signature);"
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,498,"signatureLength = IOUtils.readFully(in, signature);"
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,489,"f (ZipArchiveInputStream.matches(signature, signatureLength)) {"
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,490,"eturn createArchiveInputStream(ZIP, in);"
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,491," else if (JarArchiveInputStream.matches(signature, signatureLength)) {"
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,492,"eturn createArchiveInputStream(JAR, in);"
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,493," else if (ArArchiveInputStream.matches(signature, signatureLength)) {"
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,494,"eturn createArchiveInputStream(AR, in);"
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,495," else if (CpioArchiveInputStream.matches(signature, signatureLength)) {"
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,496,"eturn createArchiveInputStream(CPIO, in);"
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,497," else if (ArjArchiveInputStream.matches(signature, signatureLength)) {"
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,498,"eturn createArchiveInputStream(ARJ, in);"
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,499," else if (SevenZFile.matches(signature, signatureLength)) {"
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,500,hrow new StreamingNotSupportedException(SEVEN_Z);
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,500,} catch (IOException e) {
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,501,"throw new ArchiveException(""IOException while reading signature."");"
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,503,/ Dump needs a bigger buffer to check the signature;
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,504,inal byte[] dumpsig = new byte[DUMP_SIGNATURE_SIZE];
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,505,n.mark(dumpsig.length);
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,504,"if (JarArchiveInputStream.matches(signature, signatureLength)) {"
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,505,return JAR;
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,506,"} else if (ZipArchiveInputStream.matches(signature, signatureLength)) {"
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,507,return ZIP;
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,508,"} else if (ArArchiveInputStream.matches(signature, signatureLength)) {"
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,509,return AR;
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,510,"} else if (CpioArchiveInputStream.matches(signature, signatureLength)) {"
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,511,return CPIO;
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,512,"} else if (ArjArchiveInputStream.matches(signature, signatureLength)) {"
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,513,return ARJ;
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,514,"} else if (SevenZFile.matches(signature, signatureLength)) {"
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,515,throw new StreamingNotSupportedException(SEVEN_Z);
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,518,// Dump needs a bigger buffer to check the signature;
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,519,final byte[] dumpsig = new byte[DUMP_SIGNATURE_SIZE];
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,520,in.mark(dumpsig.length);
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,521,try {
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,508,"f (DumpArchiveInputStream.matches(dumpsig, signatureLength)) {"
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,509,"eturn createArchiveInputStream(DUMP, in);"
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,524,} catch (IOException e) {
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,525,"throw new ArchiveException(""IOException while reading dump signature"");"
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,527,"if (DumpArchiveInputStream.matches(dumpsig, signatureLength)) {"
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,528,return DUMP;
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,512,/ Tar needs an even bigger buffer to check the signature; read the first block
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,513,inal byte[] tarHeader = new byte[TAR_HEADER_SIZE];
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,514,n.mark(tarHeader.length);
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,531,// Tar needs an even bigger buffer to check the signature; read the first block
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,532,final byte[] tarHeader = new byte[TAR_HEADER_SIZE];
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,533,in.mark(tarHeader.length);
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,534,try {
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,517,"f (TarArchiveInputStream.matches(tarHeader, signatureLength)) {"
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,518,"eturn createArchiveInputStream(TAR, in);"
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,520,/ COMPRESS-117 - improve auto-recognition
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,521,f (signatureLength >= TAR_HEADER_SIZE) {
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,522,arArchiveInputStream tais = null;
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,523,ry {
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,524,ais = new TarArchiveInputStream(new ByteArrayInputStream(tarHeader));
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,525,/ COMPRESS-191 - verify the header checksum
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,526,f (tais.getNextTarEntry().isCheckSumOK()) {
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,527,"eturn createArchiveInputStream(TAR, in);"
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,529, catch (final Exception e) { // NOPMD
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,530,/ can generate IllegalArgumentException as well
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,531,/ as IOException
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,532,"/ autodetection, simply not a TAR"
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,533,/ ignored
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,534, finally {
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,535,OUtils.closeQuietly(tais);
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,537,} catch (IOException e) {
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,538,"throw new ArchiveException(""IOException while reading tar signature"");"
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,540,"if (TarArchiveInputStream.matches(tarHeader, signatureLength)) {"
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,541,return TAR;
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,544,// COMPRESS-117 - improve auto-recognition
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,545,if (signatureLength >= TAR_HEADER_SIZE) {
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,546,TarArchiveInputStream tais = null;
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,547,try {
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,548,tais = new TarArchiveInputStream(new ByteArrayInputStream(tarHeader));
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,549,// COMPRESS-191 - verify the header checksum
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,550,if (tais.getNextTarEntry().isCheckSumOK()) {
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,551,return TAR;
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,553,} catch (final Exception e) { // NOPMD
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,554,// can generate IllegalArgumentException as well
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,555,// as IOException
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,556,"// autodetection, simply not a TAR"
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,557,// ignored
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,558,} finally {
True,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,559,IOUtils.closeQuietly(tais);
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,538, catch (final IOException e) {
False,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,src/main/java/org/apache/commons/compress/archivers/ArchiveStreamFactory.java,539,"hrow new ArchiveException(""Could not use reset and mark operations."", e);"
False,src/main/java/org/apache/commons/compress/compressors/CompressorStreamFactory.java,src/main/java/org/apache/commons/compress/compressors/CompressorStreamFactory.java,403,"hrow new CompressorException(""Failed while reading signature from InputStream."", e);"
True,src/main/java/org/apache/commons/compress/compressors/CompressorStreamFactory.java,src/main/java/org/apache/commons/compress/compressors/CompressorStreamFactory.java,403,"throw new CompressorException(""IOException while reading signature."", e);"
True,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,1,package org.apache.commons.compress;/*
True,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,2,* Licensed to the Apache Software Foundation (ASF) under one or more
True,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,3,* contributor license agreements.  See the NOTICE file distributed with
True,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,4,* this work for additional information regarding copyright ownership.
True,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,5,"* The ASF licenses this file to You under the Apache License, Version 2.0"
True,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,6,"* (the ""License""); you may not use this file except in compliance with"
True,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,7,* the License.  You may obtain a copy of the License at
True,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,9,*   http://www.apache.org/licenses/LICENSE-2.0
True,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,11,"* Unless required by applicable law or agreed to in writing, software"
True,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,12,"* distributed under the License is distributed on an ""AS IS"" BASIS,"
True,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,13,"* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied."
True,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,14,* See the License for the specific language governing permissions and
True,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,15,* limitations under the License.
True,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,19,import java.io.IOException;
True,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,20,import java.io.InputStream;
True,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,23,* Simple mock InputStream that always throws an IOException
True,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,24,"* when {@link #read()} or {@link #read(byte[], int, int)}"
True,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,25,* is called.
True,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,27,public class MockEvilInputStream extends InputStream {
True,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,29,@Override
True,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,30,public int read() throws IOException {
True,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,31,"throw new IOException(""Evil"");"
True,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,34,@Override
True,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,35,"public int read(byte[] bytes, int offset, int length) throws IOException {"
True,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,src/test/java/org/apache/commons/compress/MockEvilInputStream.java,36,"throw new IOException(""Evil"");"
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,35,import org.apache.commons.compress.MockEvilInputStream;
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,230,@Test
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,231,public void testDetect() throws Exception {
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,232,for (String extension : new String[]{
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,233,"ArchiveStreamFactory.ARJ,"
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,234,"ArchiveStreamFactory.CPIO,"
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,235,"ArchiveStreamFactory.DUMP,"
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,236,"ArchiveStreamFactory.JAR,"
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,237,"ArchiveStreamFactory.TAR,"
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,238,//TODO-- figure out how to differentiate btwn JAR and ZIP
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,239,//               ArchiveStreamFactory.ZIP
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,241,"assertEquals(extension, detect(""bla.""+extension));"
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,244,try {
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,245,ArchiveStreamFactory.detect(new BufferedInputStream(new ByteArrayInputStream(new byte[0])));
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,246,"fail(""shouldn't be able to detect empty stream"");"
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,247,} catch (ArchiveException e) {
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,248,"assertEquals(""No Archiver found for the stream signature"", e.getMessage());"
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,251,try {
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,252,ArchiveStreamFactory.detect(null);
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,253,"fail(""shouldn't be able to detect null stream"");"
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,254,} catch (IllegalArgumentException e) {
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,255,"assertEquals(""Stream must not be null."", e.getMessage());"
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,258,try {
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,259,ArchiveStreamFactory.detect(new BufferedInputStream(new MockEvilInputStream()));
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,260,"fail(""Expected ArchiveException"");"
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,261,} catch (ArchiveException e) {
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,262,"assertEquals(""IOException while reading signature."", e.getMessage());"
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,266,"private String detect(String resource) throws IOException, ArchiveException {"
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,267,try(InputStream in = new BufferedInputStream(new FileInputStream(
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,268,getFile(resource)))) {
True,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,src/test/java/org/apache/commons/compress/archivers/ArchiveStreamFactoryTest.java,269,return ArchiveStreamFactory.detect(in);
True,src/test/java/org/apache/commons/compress/compressors/DetectCompressorTestCase.java,src/test/java/org/apache/commons/compress/compressors/DetectCompressorTestCase.java,34,import org.apache.commons.compress.MockEvilInputStream;
False,src/test/java/org/apache/commons/compress/compressors/DetectCompressorTestCase.java,src/test/java/org/apache/commons/compress/compressors/DetectCompressorTestCase.java,134,"ssertTrue(e.getMessage().contains(""No Compressor found""));"
True,src/test/java/org/apache/commons/compress/compressors/DetectCompressorTestCase.java,src/test/java/org/apache/commons/compress/compressors/DetectCompressorTestCase.java,136,"assertEquals(""No Compressor found for the stream signature."", e.getMessage());"
False,src/test/java/org/apache/commons/compress/compressors/DetectCompressorTestCase.java,src/test/java/org/apache/commons/compress/compressors/DetectCompressorTestCase.java,145,ompressorStreamFactory.detect(new BufferedInputStream(new BadInputStream()));
True,src/test/java/org/apache/commons/compress/compressors/DetectCompressorTestCase.java,src/test/java/org/apache/commons/compress/compressors/DetectCompressorTestCase.java,147,CompressorStreamFactory.detect(new BufferedInputStream(new MockEvilInputStream()));
False,src/test/java/org/apache/commons/compress/compressors/DetectCompressorTestCase.java,src/test/java/org/apache/commons/compress/compressors/DetectCompressorTestCase.java,148,"ssertEquals(""Failed while reading signature from InputStream."", e.getMessage());"
True,src/test/java/org/apache/commons/compress/compressors/DetectCompressorTestCase.java,src/test/java/org/apache/commons/compress/compressors/DetectCompressorTestCase.java,150,"assertEquals(""IOException while reading signature."", e.getMessage());"
False,src/test/java/org/apache/commons/compress/compressors/DetectCompressorTestCase.java,src/test/java/org/apache/commons/compress/compressors/DetectCompressorTestCase.java,220,rivate static class BadInputStream extends InputStream {
False,src/test/java/org/apache/commons/compress/compressors/DetectCompressorTestCase.java,src/test/java/org/apache/commons/compress/compressors/DetectCompressorTestCase.java,221,Override
False,src/test/java/org/apache/commons/compress/compressors/DetectCompressorTestCase.java,src/test/java/org/apache/commons/compress/compressors/DetectCompressorTestCase.java,222,ublic int read() throws IOException {
False,src/test/java/org/apache/commons/compress/compressors/DetectCompressorTestCase.java,src/test/java/org/apache/commons/compress/compressors/DetectCompressorTestCase.java,223,"hrow new IOException(""Bad"");"
False,src/test/java/org/apache/commons/compress/compressors/DetectCompressorTestCase.java,src/test/java/org/apache/commons/compress/compressors/DetectCompressorTestCase.java,226,Override
False,src/test/java/org/apache/commons/compress/compressors/DetectCompressorTestCase.java,src/test/java/org/apache/commons/compress/compressors/DetectCompressorTestCase.java,227,"ublic int read(byte[] bytes, int offset, int length) throws IOException {"
False,src/test/java/org/apache/commons/compress/compressors/DetectCompressorTestCase.java,src/test/java/org/apache/commons/compress/compressors/DetectCompressorTestCase.java,228,"hrow new IOException(""Bad"");"
