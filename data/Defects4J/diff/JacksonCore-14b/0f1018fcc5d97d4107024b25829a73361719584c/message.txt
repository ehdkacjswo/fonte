trying to complete generator-filtering, complicated stuff.
