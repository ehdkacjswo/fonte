Moved some implementation to a better spot.
