Pushed complexity to separate classes
