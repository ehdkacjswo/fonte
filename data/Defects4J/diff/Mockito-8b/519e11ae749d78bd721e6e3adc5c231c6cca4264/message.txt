Some refactoring before thinning up the Invocation implementation.
