Refactoring while working on issue 184
