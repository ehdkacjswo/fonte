Moved out more implementation details out of the Invocation class.
