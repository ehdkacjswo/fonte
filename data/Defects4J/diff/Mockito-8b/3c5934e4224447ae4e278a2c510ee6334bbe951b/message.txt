Started moving out stuff to a public interface type. Moved some implementation elsewhere so that the public api can be thin.
