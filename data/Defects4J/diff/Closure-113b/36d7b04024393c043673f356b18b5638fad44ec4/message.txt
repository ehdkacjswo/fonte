I have a scenario where I'm hitting a NullPointerException using the --create_externs_from_exports option.

The simplified scenario is:

var id = function() {return 'id'};
var foo = function() {
var id;
return;
}
goog.exportSymbol('id', id);

In the compiler's ExternExportsPass class, there's a definitionMap that maps symbols names to Nodes. In the node traversal, the id function is found but then later overwritten by the the local variable id in function foo.

So, clearly this is bad behavior.
Addressing by moving the ExternExportsPass to occur after normalization.
-------------
Created by MOE: http://code.google.com/p/moe-java
MOE_MIGRATED_REVID=46355600
