Further improvements to reduce hash collisions, now for 1-4 byte ids
