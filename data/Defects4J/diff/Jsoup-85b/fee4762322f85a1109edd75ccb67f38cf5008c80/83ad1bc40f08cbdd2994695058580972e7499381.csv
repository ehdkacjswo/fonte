is_addition,old_file_path,new_file_path,line_num,content
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,46,* Setter to disable\enable SSL certificates checks during https connection
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,47,* <p/>
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,48,* By default all connections over HTTPS perform normal validation of certificates.
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,49,* <b>NB!</b>Use this feature at your own risk.
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,50,* <p/>
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,51,"* Some websites use self generated certificates to sign data, which sometimes are expired,"
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,52,"* by default request to those websites would fail, this feature allows to communicate to them."
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,54,* @param value
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,56,Connection setValidateSSLCertificates(boolean value);
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,488,* get current state of security enabling\disabling feature
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,490,* @return
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,492,boolean isValidateSSLCertificates();
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,495,* Disable SSL certificates checks.
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,496,* @param value
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,498,void setValidateSSLCertificates(boolean value);
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,10,import javax.net.ssl.*;
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,18,import java.security.KeyManagementException;
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,19,import java.security.NoSuchAlgorithmException;
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,20,import java.security.cert.X509Certificate;
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,69,public Connection setValidateSSLCertificates(boolean value) {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,70,req.setValidateSSLCertificates(value);
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,71,return this;
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,356,//      always default to validateSSLCertificates connections in https
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,357,private boolean validateSSLCertificates = true;
False,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,348,rivate Request() {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,359,private Request() {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,435,public boolean isValidateSSLCertificates() {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,436,return validateSSLCertificates;
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,439,public void setValidateSSLCertificates(boolean value) {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,440,validateSSLCertificates = value;
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,446,private static SSLSocketFactory sslSocketFactory;
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,609,if (conn instanceof HttpsURLConnection) {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,610,if (!req.isValidateSSLCertificates()) {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,611,initUnSecureSSL();
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,612,((HttpsURLConnection)conn).setSSLSocketFactory(sslSocketFactory);
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,613,((HttpsURLConnection)conn).setHostnameVerifier(getInsecureVerifier());
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,628,* Instantiate Hostname Verifier that does nothing.
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,629,* This is used for connections with disabled SSL certificates validation.
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,632,* @return Hostname Verifier that does nothing and accepts all hostnames
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,634,private static HostnameVerifier getInsecureVerifier() {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,635,HostnameVerifier hv = new HostnameVerifier() {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,636,"public boolean verify(String urlHostName, SSLSession session) {"
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,637,return true;
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,640,return hv;
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,644,* Initialise Trust manager that does not validate certificate chains and
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,645,* add it to current SSLContext.
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,646,* <p/>
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,647,* please not that this method will only perform action if sslSocketFactory is not yet
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,648,* instantiated.
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,650,* @throws IOException
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,652,private static synchronized void initUnSecureSSL() throws IOException {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,653,if (sslSocketFactory == null) {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,654,// Create a trust manager that does not validate certificate chains
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,655,final TrustManager[] trustAllCerts = new TrustManager[]{new X509TrustManager() {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,657,"public void checkClientTrusted(final X509Certificate[] chain, final String authType) {"
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,660,"public void checkServerTrusted(final X509Certificate[] chain, final String authType) {"
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,663,public X509Certificate[] getAcceptedIssuers() {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,664,return null;
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,668,// Install the all-trusting trust manager
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,669,final SSLContext sslContext;
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,670,try {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,671,"sslContext = SSLContext.getInstance(""SSL"");"
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,672,"sslContext.init(null, trustAllCerts, new java.security.SecureRandom());"
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,673,// Create an ssl socket factory with our all-trusting manager
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,674,sslSocketFactory = sslContext.getSocketFactory();
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,675,} catch (NoSuchAlgorithmException e) {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,676,"throw new IOException(""Can't create unsecure trust manager"");"
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,677,} catch (KeyManagementException e) {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,678,"throw new IOException(""Can't create unsecure trust manager"");"
False,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,633,"/ ignores path, date, domain, secure et al. req'd?"
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,720,"// ignores path, date, domain, validateSSLCertificates et al. req'd?"
False,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,15,mport java.io.FileNotFoundException;
False,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,21,mport static org.junit.Assert.assertEquals;
False,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,22,mport static org.junit.Assert.assertTrue;
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,20,import static org.hamcrest.core.Is.is;
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,21,import static org.junit.Assert.*;
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,29,"private static final String WEBSITE_WITH_INVALID_CERTIFICATE = ""https://certs.cac.washington.edu/CAtest/"";"
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,30,"private static final String WEBSITE_WITH_SNI = ""https://sni.velox.ch/"";"
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,303,* Verify that security disabling feature works properly.
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,304,* <p/>
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,305,* 1. try to hit url with invalid certificate and evaluate that exception is thrown
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,307,* @throws Exception
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,309,@Test(expected = IOException.class)
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,310,public void testUnsafeFail() throws Exception {
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,311,String url = WEBSITE_WITH_INVALID_CERTIFICATE;
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,312,Jsoup.connect(url).execute();
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,317,* Verify that requests to websites with SNI fail on jdk 1.6
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,318,* <p/>
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,319,* read for more details:
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,320,* http://en.wikipedia.org/wiki/Server_Name_Indication
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,322,* Test is ignored independent from others as it requires JDK 1.6
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,323,* @throws Exception
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,325,@Test(expected = IOException.class)
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,326,@Ignore
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,327,public void testSNIFail() throws Exception {
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,328,String url = WEBSITE_WITH_SNI;
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,329,Jsoup.connect(url).execute();
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,333,* Verify that requests to websites with SNI pass
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,334,* <p/>
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,335,* <b>NB!</b> this test is FAILING right now on jdk 1.6
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,337,* @throws Exception
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,339,@Test
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,340,@Ignore
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,341,public void testSNIPass() throws Exception {
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,342,String url = WEBSITE_WITH_SNI;
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,343,Connection.Response defaultRes = Jsoup.connect(url).setValidateSSLCertificates(false).execute();
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,344,"assertThat(defaultRes.statusCode(), is(200));"
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,348,* Verify that security disabling feature works properly.
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,349,* <p/>
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,350,* 1. disable security checks and call the same url to verify that content is consumed correctly
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,352,* @throws Exception
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,354,@Test
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,355,public void testUnsafePass() throws Exception {
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,356,String url = WEBSITE_WITH_INVALID_CERTIFICATE;
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,357,Connection.Response defaultRes = Jsoup.connect(url).setValidateSSLCertificates(false).execute();
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,358,"assertThat(defaultRes.statusCode(), is(200));"
