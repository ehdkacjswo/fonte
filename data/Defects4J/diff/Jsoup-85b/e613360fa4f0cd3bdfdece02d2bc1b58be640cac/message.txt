Annotations added and some cleanup.