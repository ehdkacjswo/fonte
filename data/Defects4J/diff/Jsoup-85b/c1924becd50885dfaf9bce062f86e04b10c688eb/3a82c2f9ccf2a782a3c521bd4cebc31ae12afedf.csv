is_addition,old_file_path,new_file_path,line_num,content
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,124,* Disable/enable TSL certificates validation for HTTPS requests.
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,125,* <p/>
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,126,* By default this is <b>true</b>; all
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,127,"* connections over HTTPS perform normal validation of certificates, and will abort requests if the provided"
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,128,* certificate does not validate.
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,129,* <p/>
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,130,"* Some servers use expired, self-generated certificates; or your JDK may not"
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,131,"* support SNI hosts. In which case, you may want to enable this setting."
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,132,* <p/> <b>Be careful</b> and understand why you need to disable these validations.
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,133,* @param value if should validate TSL (SSL) certificates. <b>true</b> by default.
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,134,"* @return this Connection, for chaining"
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,136,Connection validateTLSCertificates(boolean value);
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,464,* Get the current state of TLS (SSL) certificate validation.
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,465,* @return true if TLS cert validation enabled
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,467,boolean validateTLSCertificates();
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,470,* Set TLS certificate validation.
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,471,* @param value set false to ignore TLS (SSL) certificates
True,src/main/java/org/jsoup/Connection.java,src/main/java/org/jsoup/Connection.java,473,void validateTLSCertificates(boolean value);
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,10,import javax.net.ssl.*;
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,18,import java.security.KeyManagementException;
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,19,import java.security.NoSuchAlgorithmException;
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,20,import java.security.cert.X509Certificate;
False,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,21,mport static org.jsoup.Connection.Method;
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,124,public Connection validateTLSCertificates(boolean value) {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,125,req.validateTLSCertificates(value);
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,126,return this;
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,354,private boolean validateTSLCertificates = true;
False,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,348,rivate Request() {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,356,private Request() {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,399,public boolean validateTLSCertificates() {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,400,return validateTSLCertificates;
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,403,public void validateTLSCertificates(boolean value) {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,404,validateTSLCertificates = value;
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,443,private static SSLSocketFactory sslSocketFactory;
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,606,if (conn instanceof HttpsURLConnection) {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,607,if (!req.validateTLSCertificates()) {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,608,initUnSecureTSL();
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,609,((HttpsURLConnection)conn).setSSLSocketFactory(sslSocketFactory);
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,610,((HttpsURLConnection)conn).setHostnameVerifier(getInsecureVerifier());
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,625,* Instantiate Hostname Verifier that does nothing.
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,626,* This is used for connections with disabled SSL certificates validation.
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,629,* @return Hostname Verifier that does nothing and accepts all hostnames
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,631,private static HostnameVerifier getInsecureVerifier() {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,632,return new HostnameVerifier() {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,633,"public boolean verify(String urlHostName, SSLSession session) {"
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,634,return true;
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,640,* Initialise Trust manager that does not validate certificate chains and
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,641,* add it to current SSLContext.
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,642,* <p/>
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,643,* please not that this method will only perform action if sslSocketFactory is not yet
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,644,* instantiated.
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,646,* @throws IOException
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,648,private static synchronized void initUnSecureTSL() throws IOException {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,649,if (sslSocketFactory == null) {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,650,// Create a trust manager that does not validate certificate chains
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,651,final TrustManager[] trustAllCerts = new TrustManager[]{new X509TrustManager() {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,653,"public void checkClientTrusted(final X509Certificate[] chain, final String authType) {"
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,656,"public void checkServerTrusted(final X509Certificate[] chain, final String authType) {"
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,659,public X509Certificate[] getAcceptedIssuers() {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,660,return null;
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,664,// Install the all-trusting trust manager
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,665,final SSLContext sslContext;
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,666,try {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,667,"sslContext = SSLContext.getInstance(""SSL"");"
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,668,"sslContext.init(null, trustAllCerts, new java.security.SecureRandom());"
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,669,// Create an ssl socket factory with our all-trusting manager
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,670,sslSocketFactory = sslContext.getSocketFactory();
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,671,} catch (NoSuchAlgorithmException e) {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,672,"throw new IOException(""Can't create unsecure trust manager"");"
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,673,} catch (KeyManagementException e) {
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,674,"throw new IOException(""Can't create unsecure trust manager"");"
False,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,633,"/ ignores path, date, domain, secure et al. req'd?"
True,src/main/java/org/jsoup/helper/HttpConnection.java,src/main/java/org/jsoup/helper/HttpConnection.java,716,"// ignores path, date, domain, validateTLSCertificates et al. req'd?"
False,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,15,mport java.io.FileNotFoundException;
False,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,21,mport static org.junit.Assert.assertEquals;
False,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,22,mport static org.junit.Assert.assertTrue;
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,20,import static org.hamcrest.core.Is.is;
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,21,import static org.junit.Assert.*;
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,29,"private static final String WEBSITE_WITH_INVALID_CERTIFICATE = ""https://certs.cac.washington.edu/CAtest/"";"
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,30,"private static final String WEBSITE_WITH_SNI = ""https://jsoup.org/"";"
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,303,* Verify that security disabling feature works properly.
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,304,* <p/>
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,305,* 1. try to hit url with invalid certificate and evaluate that exception is thrown
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,307,* @throws Exception
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,309,@Test(expected = IOException.class)
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,310,public void testUnsafeFail() throws Exception {
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,311,String url = WEBSITE_WITH_INVALID_CERTIFICATE;
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,312,Jsoup.connect(url).execute();
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,317,* Verify that requests to websites with SNI fail on jdk 1.6
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,318,* <p/>
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,319,* read for more details:
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,320,* http://en.wikipedia.org/wiki/Server_Name_Indication
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,322,* Test is ignored independent from others as it requires JDK 1.6
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,323,* @throws Exception
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,325,@Test(expected = IOException.class)
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,326,public void testSNIFail() throws Exception {
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,327,String url = WEBSITE_WITH_SNI;
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,328,Jsoup.connect(url).execute();
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,332,* Verify that requests to websites with SNI pass
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,333,* <p/>
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,334,* <b>NB!</b> this test is FAILING right now on jdk 1.6
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,336,* @throws Exception
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,338,@Test
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,339,public void testSNIPass() throws Exception {
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,340,String url = WEBSITE_WITH_SNI;
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,341,Connection.Response defaultRes = Jsoup.connect(url).validateTLSCertificates(false).execute();
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,342,"assertThat(defaultRes.statusCode(), is(200));"
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,346,* Verify that security disabling feature works properly.
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,347,* <p/>
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,348,* 1. disable security checks and call the same url to verify that content is consumed correctly
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,350,* @throws Exception
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,352,@Test
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,353,public void testUnsafePass() throws Exception {
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,354,String url = WEBSITE_WITH_INVALID_CERTIFICATE;
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,355,Connection.Response defaultRes = Jsoup.connect(url).validateTLSCertificates(false).execute();
True,src/test/java/org/jsoup/integration/UrlConnectTest.java,src/test/java/org/jsoup/integration/UrlConnectTest.java,356,"assertThat(defaultRes.statusCode(), is(200));"
