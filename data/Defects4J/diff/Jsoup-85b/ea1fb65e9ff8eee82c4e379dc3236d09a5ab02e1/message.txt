Refactored Attributes to be an array pair vs LinkedHashSet

Also a couple perf (cpu / garbage) tweaks
